# ‚úÖ AstronomyAPI - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç –∏ —Ä–µ—à–µ–Ω–∏–µ

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê

–ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —Ç–µ–ø–µ—Ä—å **—Ä–∞–±–æ—Ç–∞—é—Ç** —á–µ—Ä–µ–∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API.

---

## üìä –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å AstronomyAPI

### –ü—Ä–æ–±–ª–µ–º–∞
AstronomyAPI **–º–∏–≥—Ä–∏—Ä–æ–≤–∞–ª –Ω–∞ AWS** –∏ –∏–∑–º–µ–Ω–∏–ª –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞:

```
HTTP 403 Forbidden
{
  "Message": "User is not authorized to access this resource 
  with an explicit deny in an identity-based policy"
}
```

**–ü—Ä–∏—á–∏–Ω–∞**: AWS IAM –ø–æ–ª–∏—Ç–∏–∫–∞ **—è–≤–Ω–æ –∑–∞–ø—Ä–µ—â–∞–µ—Ç** –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –¥–ª—è –≤—Å–µ—Ö –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤.

### –ü—Ä–æ–≤–µ—Ä–∫–∞
‚úÖ –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã (Basic Auth —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)  
‚ùå AWS IAM –ø–æ–ª–∏—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø  
üîç Endpoint –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: `/api/v2/bodies/events/:body`  
üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://docs.astronomyapi.com/

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å (Open-Meteo)

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
1. **–ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å**: `AstroEventsAlternativeService.php`
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ**: AstronomyAPI ‚Üí Open-Meteo fallback
3. **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π API**: Open-Meteo (–±–µ–∑ –∫–ª—é—á–µ–π, –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  AstroController    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚ñ∫ Try: AstronomyApiService (Basic Auth)
           ‚îÇ   ‚îî‚îÄ‚ñ∫ ‚ùå AWS IAM deny (403)
           ‚îÇ
           ‚îî‚îÄ‚ñ∫ Fallback: AstroEventsAlternativeService
               ‚îî‚îÄ‚ñ∫ ‚úÖ Open-Meteo API (200 OK)
```

### –ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### 1. –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å (Open-Meteo)
```php
// app/Services/AstroEventsAlternativeService.php

public function getEvents(float $lat, float $lon, int $days = 7): array
{
    $url = 'https://api.open-meteo.com/v1/forecast';
    $params = [
        'latitude' => $lat,
        'longitude' => $lon,
        'daily' => 'sunrise,sunset,daylight_duration,sunshine_duration',
        'timezone' => 'auto',
    ];
    
    // –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π API, –±–µ–∑ –∫–ª—é—á–µ–π!
    $response = Http::get($url, $params);
    // ... —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
}
```

#### 2. –£–º–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å fallback
```php
// app/Http/Controllers/AstroController.php

public function events(Request $request)
{
    // –ü—Ä–æ–±—É–µ–º AstronomyAPI
    $result = $this->astronomyApi->getEvents($lat, $lon, $days);
    
    // –ï—Å–ª–∏ –ø—É—Å—Ç–æ - –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ Open-Meteo
    if (empty($result['data'])) {
        Log::info("Falling back to alternative service");
        $result = $this->alternativeApi->getEvents($lat, $lon, $days);
    }
    
    return response()->json($result);
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ
```bash
curl "http://localhost:8080/api/astro/events?lat=55.7558&lon=37.6176&days=3"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
```json
{
  "data": {
    "sun": [{
      "body": {"id": "sun", "name": "Sun"},
      "events": [
        {
          "date": "2025-12-09",
          "sun": {
            "sunrise": "2025-12-09T08:46",
            "sunset": "2025-12-09T15:57",
            "daylight_duration": "07:10"
          }
        }
      ]
    }]
  },
  "source": "Open-Meteo (Free Alternative)"
}
```

‚úÖ **–†–ê–ë–û–¢–ê–ï–¢!**

### –¢–µ—Å—Ç 2: –Ø–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
```bash
curl "http://localhost:8080/api/astro/events?lat=60.0354&lon=30.2073&days=2&alternative=true"
```

‚úÖ **–†–ê–ë–û–¢–ê–ï–¢!** (–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥: –≤–æ—Å—Ö–æ–¥ 09:49, –∑–∞–∫–∞—Ç 15:54)

### –õ–æ–≥–∏ Laravel
```
[2025-12-09 23:42:20] AstronomyAPI Request for sun ‚Üí 403 AWS IAM deny
[2025-12-09 23:42:21] AstronomyAPI returned empty data, falling back
[2025-12-09 23:42:21] Open-Meteo API Request
[2025-12-09 23:42:21] Open-Meteo API Success {"status":200,"has_data":true}
```

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω–æ!**

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ API

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | AstronomyAPI | Open-Meteo |
|----------------|--------------|------------|
| **–°—Ç–∞—Ç—É—Å** | ‚ùå AWS IAM deny | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | Basic Auth (–∫–ª—é—á–∏) | ‚ùå –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) | ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ |
| **–õ–∏–º–∏—Ç—ã** | 1000 req/–º–µ—Å—è—Ü | ‚úÖ –ë–µ–∑ –ª–∏–º–∏—Ç–æ–≤ |
| **–î–∞–Ω–Ω—ã–µ –°–æ–ª–Ω—Ü–∞** | –í–æ—Å—Ö–æ–¥/–∑–∞–∫–∞—Ç/–∑–∞—Ç–º–µ–Ω–∏—è | ‚úÖ –í–æ—Å—Ö–æ–¥/–∑–∞–∫–∞—Ç/–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| **–î–∞–Ω–Ω—ã–µ –õ—É–Ω—ã** | –§–∞–∑—ã/–∑–∞—Ç–º–µ–Ω–∏—è | ‚ö†Ô∏è –ù–µ—Ç (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å) |
| **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** | https://docs.astronomyapi.com/ | https://open-meteo.com/ |

---

## üîß –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

### ‚úÖ –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
1. `app/Services/AstroEventsAlternativeService.php` - —Å–µ—Ä–≤–∏—Å Open-Meteo
2. `ASTRONOMY_API_AWS_MIGRATION.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏
3. `ASTRONOMY_API_FINAL_STATUS.md` - –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç

### ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã
1. `app/Services/AstronomyApiService.php`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω endpoint: `/bodies/events/:body`
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è Basic Auth
   - –†–∞–∑–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è sun/moon

2. `app/Http/Controllers/AstroController.php`
   - –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `?alternative=true`

---

## üöÄ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (6 –∏–∑ 6)

1. üõ∞Ô∏è **ISS Tracking** - –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ú–ö–° –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
2. üî≠ **JWST Images** - –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ç–µ–ª–µ—Å–∫–æ–ø–∞ James Webb
3. üåå **NASA APOD** - –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ –¥–Ω—è
4. üî¨ **OSDR Data** - –ù–∞—É—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ NASA
5. üéÆ **Legacy Features** - Pascal/Python —Å–µ—Ä–≤–∏—Å—ã
6. ‚≠ê **Astronomy Events** - –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è ‚úÖ **–¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢!**
   - –ò—Å—Ç–æ—á–Ω–∏–∫: Open-Meteo (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
   - –î–∞–Ω–Ω—ã–µ: –≤–æ—Å—Ö–æ–¥/–∑–∞–∫–∞—Ç, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–Ω—è

---

## üìù API Usage

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
```bash
GET /api/astro/events?lat=55.7558&lon=37.6176&days=7
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
- `lat` (float): –®–∏—Ä–æ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 55.7558 - –ú–æ—Å–∫–≤–∞)
- `lon` (float): –î–æ–ª–≥–æ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 37.6176 - –ú–æ—Å–∫–≤–∞)
- `days` (int): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π (1-30, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 7)
- `alternative` (bool): –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Open-Meteo

### –ü—Ä–∏–º–µ—Ä—ã –≥–æ—Ä–æ–¥–æ–≤

**–ú–æ—Å–∫–≤–∞**:
```bash
curl "http://localhost:8080/api/astro/events?lat=55.7558&lon=37.6176&days=3"
```

**–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥**:
```bash
curl "http://localhost:8080/api/astro/events?lat=59.9343&lon=30.3351&days=3"
```

**–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫**:
```bash
curl "http://localhost:8080/api/astro/events?lat=43.1150&lon=131.8855&days=3"
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ
1. ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Open-Meteo** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
2. üìß **–°–≤—è–∑–∞—Ç—å—Å—è —Å AstronomyAPI** - –≤—ã—è—Å–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è AWS IAM
3. üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–ø—ã—Ç–∫–∏ –∏ fallback

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ
1. üåô **–î–æ–±–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –õ—É–Ω—ã** - Open-Meteo –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç moonrise/moonset
2. üåç **–†–∞—Å—à–∏—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–≥–æ–¥—É, UV-–∏–Ω–¥–µ–∫—Å
3. üí∞ **–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å AstronomyAPI** - –µ—Å–ª–∏ –æ–Ω–∏ –∏—Å–ø—Ä–∞–≤—è—Ç –¥–æ—Å—Ç—É–ø

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### AstronomyAPI (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://docs.astronomyapi.com/
- üìä –°—Ç–∞—Ç—É—Å: https://astronomyapi.statuspage.io/
- üí∞ –ö—Ä–∞—É–¥—Ñ–∞–Ω–¥–∏–Ω–≥: https://gofund.me/e41e2ff0

### Open-Meteo (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- üè† –ì–ª–∞–≤–Ω–∞—è: https://open-meteo.com/
- üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://open-meteo.com/en/docs
- üåê API: https://api.open-meteo.com/v1/forecast

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
- üåÖ Sunrise-Sunset.org: https://sunrise-sunset.org/api
- üïê TimeAndDate API: https://dev.timeanddate.com/ (–ø–ª–∞—Ç–Ω—ã–π)

---

## ‚ú® –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é!**

- ‚úÖ –ê—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å (Open-Meteo)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
- ‚úÖ Graceful degradation
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
- ‚úÖ –í—Å–µ 6 —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã

**–ú–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è!** üéâ

---

**–î–∞—Ç–∞**: 2025-12-09  
**–í–µ—Ä—Å–∏—è**: v2.0 (—Å Open-Meteo fallback)  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
